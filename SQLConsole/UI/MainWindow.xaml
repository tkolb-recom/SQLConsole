<RibbonWindow x:Class="Recom.SQLConsole.UI.MainWindow"
              xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
              xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
              xmlns:ui="clr-namespace:Recom.SQLConsole.UI"
              xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
              xmlns:properties="clr-namespace:Recom.SQLConsole.Properties"
              mc:Ignorable="d"
              Title="{Binding WindowTitle}" Height="600" Width="800">
    <Window.DataContext>
        <ui:MainViewModel />
    </Window.DataContext>
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Themes/Icons.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <DataTemplate x:Key="RecentFileTemplate" DataType="{x:Type properties:RecentFile}">
                <RibbonApplicationMenuItem
                    Header="{Binding}"
                    ToolTip="{Binding FullPath}"
                    Command="{Binding DataContext.OpenRecentFileCommand, RelativeSource={RelativeSource AncestorType={x:Type RibbonWindow}}}"
                    CommandParameter="{Binding}"
                    ImageSource="{StaticResource ImageDocument}">
                    <RibbonApplicationMenuItem.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontWeight="Bold" />
                                <TextBlock Text="{Binding FullPath}" FontSize="9" Foreground="Gray" />
                            </StackPanel>
                        </DataTemplate>
                    </RibbonApplicationMenuItem.HeaderTemplate>
                </RibbonApplicationMenuItem>
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>
    <DockPanel>
        <Ribbon DockPanel.Dock="Top">
            <Ribbon.HelpPaneContent>
                <RibbonButton SmallImageSource="{StaticResource ImageHelpSmall}" />
            </Ribbon.HelpPaneContent>

            <Ribbon.QuickAccessToolBar>
                <RibbonQuickAccessToolBar>
                    <RibbonButton ToolTip="Neu"
                                  Command="{Binding NewDocumentCommand}"
                                  SmallImageSource="{StaticResource ImageNewFileSmall}" />
                    <RibbonButton ToolTip="Öffnen"
                                  Command="{Binding OpenDocumentCommand}"
                                  SmallImageSource="{StaticResource ImageOpenFileSmall}" />
                    <RibbonButton ToolTip="Speichern"
                                  SmallImageSource="{StaticResource ImageSaveFileSmall}"
                                  Command="{Binding SaveDocumentCommand}" />
                    <RibbonButton ToolTip="Undo"
                                  SmallImageSource="{StaticResource ImageUndoSmall}" />
                    <RibbonButton ToolTip="Redo"
                                  SmallImageSource="{StaticResource ImageRedoSmall}" />
                </RibbonQuickAccessToolBar>
            </Ribbon.QuickAccessToolBar>

            <Ribbon.ApplicationMenu>
                <RibbonApplicationMenu SmallImageSource="{StaticResource ImageMenuSmall}">
                    <RibbonApplicationMenuItem Header="Neu"
                                               ImageSource="{StaticResource ImageNewFile}"
                                               Command="{Binding NewDocumentCommand}" />
                    <RibbonApplicationMenuItem Header="Öffnen"
                                               ImageSource="{StaticResource ImageOpenFile}"
                                               Command="{Binding OpenDocumentCommand}" />
                    <RibbonApplicationMenuItem Header="Speichern"
                                               ImageSource="{StaticResource ImageSaveFile}"
                                               Command="{Binding SaveDocumentCommand}" />
                    <RibbonApplicationMenuItem Header="Speichern als"
                                               ImageSource="{StaticResource ImageSaveAs}"
                                               Command="{Binding SaveDocumentAsCommand}" />

                    <RibbonApplicationMenu.FooterPaneContent>
                        <RibbonButton Label="Beenden"
                                      HorizontalAlignment="Right"
                                      SmallImageSource="{StaticResource ImageExitSmall}"
                                      Command="{Binding ExitCommand}" />
                    </RibbonApplicationMenu.FooterPaneContent>

                    <RibbonApplicationMenu.AuxiliaryPaneContent>
                        <StackPanel Margin="5">
                            <TextBlock Text="Zuletzt verwendet" />
                            <Separator />
                            <ItemsControl ItemsSource="{Binding RecentFiles}"
                                          ItemTemplate="{StaticResource RecentFileTemplate}"/>
                        </StackPanel>
                    </RibbonApplicationMenu.AuxiliaryPaneContent>
                </RibbonApplicationMenu>
            </Ribbon.ApplicationMenu>

            <RibbonTab Header="Start">
                <RibbonGroup Header="Bearbeiten">
                    <RibbonButton Label="Kopieren" SmallImageSource="{StaticResource ImageCopySmall}" />
                    <RibbonButton Label="Einfügen" SmallImageSource="{StaticResource ImagePasteSmall}" />
                    <RibbonButton Label="Ausschneiden" SmallImageSource="{StaticResource ImageCutSmall}" />
                </RibbonGroup>
                <RibbonGroup Header="Schrift">
                    <RibbonButton Label="Schrift einstellen" LargeImageSource="{StaticResource ImageFontEdit}" />
                    <RibbonComboBox ToolTip="Schriftart" SmallImageSource="{StaticResource ImageFontSelect}" />
                    <RibbonComboBox ToolTip="Schriftgröße" SmallImageSource="{StaticResource ImageFontSize}" />
                    <StackPanel Orientation="Horizontal">
                        <RibbonButton ToolTip="Schriftgrad vergrößern"
                                      SmallImageSource="{StaticResource ImageFontLarger}" />
                        <RibbonButton ToolTip="Schriftgrad verkleinern"
                                      SmallImageSource="{StaticResource ImageFontSmaller}" />
                    </StackPanel>
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Datenbank">
                <RibbonGroup Header="Verbindung">
                    <RibbonComboBox ToolTip="Datenbank"
                                    SelectionBoxWidth="150"
                                    IsEditable="False">
                        <RibbonGallery SelectedItem="{Binding SelectedDatabaseConfig, Mode=TwoWay}">
                            <RibbonGalleryCategory ItemsSource="{Binding Databases}" DisplayMemberPath="Database">
                                <!-- <RibbonGalleryCategory.ItemTemplate> -->
                                <!--     <DataTemplate DataType="{x:Type database:DatabaseConfiguration}"> -->
                                <!--         <StackPanel> -->
                                <!--             <Image Source="{StaticResource ImageConnect}" /> -->
                                <!--             <TextBlock Text="{Binding Database}" /> -->
                                <!--         </StackPanel> -->
                                <!--     </DataTemplate> -->
                                <!-- </RibbonGalleryCategory.ItemTemplate> -->
                            </RibbonGalleryCategory>

                        </RibbonGallery>
                    </RibbonComboBox>
                    <RibbonButton Label="Verbinden"
                                  LargeImageSource="{StaticResource ImageConnect}"
                                  Command="{Binding ConnectDatabaseCommand}" />
                    <RibbonButton Label="Trennen"
                                  LargeImageSource="{StaticResource ImageDisconnect}"
                                  Command="{Binding DisconnectDatabaseCommand}" />
                </RibbonGroup>
                <RibbonGroup Header="Ausführung">
                    <RibbonButton Label="Skript ausführen"
                                  LargeImageSource="{StaticResource ImageRun}"
                                  Command="{Binding RunScriptCommand}" />
                    <RibbonCheckBox x:Name="Transaction"
                                    Label="Transaktion starten"
                                    ToolTip="Wenn aktiviert, wird das Skript in einer Transaktion ausgeführt."
                                    IsChecked="{Binding StartTransaction}" />
                    <RibbonCheckBox Label="Transaktion abschließen"
                                    ToolTip="Wenn aktiviert, wird die Transaktion mit einem COMMIT abgeschlossen. Anderenfalls erfolgt ein ROLLBACK."
                                    IsEnabled="{Binding Path=IsChecked, ElementName=Transaction}"
                                    IsChecked="{Binding CommitTransaction}" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Ansicht">
                <RibbonGroup Header="Theme">
                    <RibbonButton Label="Hell"
                                  LargeImageSource="{StaticResource ImageLightTheme}" />
                    <RibbonButton Label="Dunkel"
                                  LargeImageSource="{StaticResource ImageDarkTheme}" />
                </RibbonGroup>
            </RibbonTab>
        </Ribbon>

        <avalonedit:TextEditor Document="{Binding QueryDocument}"
                               SyntaxHighlighting="SQL"
                               FontFamily="Consolas" FontSize="10pt"
                               ShowLineNumbers="True"
                               LineNumbersForeground="RoyalBlue"
                               BorderThickness="1" BorderBrush="DarkGray"
                               Margin="5">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="TextChanged">
                    <i:InvokeCommandAction Command="{Binding QueryTextChangedCommand}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </avalonedit:TextEditor>
    </DockPanel>
</RibbonWindow>